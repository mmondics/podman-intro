'use strict';var EVENTS_API_BASE_URL="https://www.nps.gov/common/components/nps/eventcalendar/EventCalendarService.cfc?method\x3dgetEvents";var EVENT_DETAIL_BASE_URL="https://www.nps.gov/planyourvisit/event-details.htm?id\x3d";window.addEventListener("load",initEventCalendarPage);var WEEKDAY_NAMES=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"];var CARDINAL_NAMES=["first","second","third","fourth","fifth"];
function initEventCalendarPage(){EVENTS_API_BASE_URL=getApiUrl();var isEventCalendarPage=jQuery(".EventCalendarPage").length>0;if(isEventCalendarPage){initMultiSelectFields();initCollapsibleForms();initDatePicker();registerEventHandlers();setStartDate(moment().format("YYYY-MM-DD")).done(submitForm)}}function getApiUrl(){var url=EVENTS_API_BASE_URL;var selectedPark=document.getElementById("SelectedPark").value;if(selectedPark)url+="\x26parkCode\x3d"+selectedPark;return url}
function initMultiSelectFields(){if(document.getElementsByClassName("MultiSelect").length>0)jQuery(".MultiSelect").multiselect({buttonTextAlignment:"start",buttonWidth:"100%",enableFiltering:true,enableCaseInsensitiveFiltering:true,enableResetButton:true,includeFilterClearButton:true,maxHeight:300,nonSelectedText:jQuery(this).attr("data-placeholder")||"All",numberDisplayed:0,onChange:submitForm,resetButtonText:"Deselect all",templates:{button:'\x3cbutton type\x3d"button" class\x3d"multiselect form-select dropdown-toggle text-start" data-bs-toggle\x3d"dropdown"\x3e\x3cspan class\x3d"multiselect-selected-text"\x3e\x3c/span\x3e\x3c/button\x3e'},
widthSynchronizationMode:"ifPopupIsSmaller"});var noParkSelected=document.getElementById("SelectedPark").value.length<1;var showParkSelect=document.getElementById("showFilterByPark").value==true;if(noParkSelected){document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display="block";document.getElementsByClassName("EventCalendar__SearchForm__ChooseState")[0].style.display="block";document.getElementsByClassName("EventCalendar__SearchForm__ChooseEventType")[0].style.display=
"block"}else{document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display="none";document.getElementsByClassName("EventCalendar__SearchForm__ChooseState")[0].style.display="none";document.getElementsByClassName("EventCalendar__SearchForm__ChooseEventType")[0].style.display="block";document.getElementsByClassName("EventCalendar__SearchForm__ChooseEventType")[0].querySelectorAll(".EventCalendar__SearchForm__InputHeader")[0].style.paddingTop="0"}if(showParkSelect)document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display=
"block";else document.getElementsByClassName("EventCalendar__SearchForm__ChoosePark")[0].style.display="none"}
function initCollapsibleForms(){var timer;var lastWidth=window.innerWidth;var collapseButton=document.querySelector("#CollapsibleFormHeading button");if(collapseButton){if(window.innerWidth<768)collapseButton.click();window.addEventListener("resize",function(){clearTimeout(timer);timer=setTimeout(function(){if(lastWidth>=768&&window.innerWidth<768&&collapseButton.getAttribute("aria-expanded")==="true")collapseButton.click();else if(lastWidth<768&&window.innerWidth>=768&&collapseButton.getAttribute("aria-expanded")===
"false")collapseButton.click();lastWidth=window.innerWidth},10)})}}function initDatePicker(){jQuery("#DatePicker").datepicker({todayBtn:false,multidate:false,autoclose:false,todayHighlight:false,immediateUpdates:true}).on("changeMonth",function(e){handleDatePickerChangeMonth(e)}).on("changeDate",function(e){handleDatePickerSelectDay(e)});showForm()}
function registerEventHandlers(){document.getElementById("FormResetButton").addEventListener("click",resetForm);document.getElementById("ShowRepeatedEvents").addEventListener("change",submitForm);document.getElementsByClassName("EventCalendar__SearchBar__SubmitButton")[0].addEventListener("click",submitForm);[].forEach.call(document.getElementsByClassName("ResultsFilterButton"),function(el){el.addEventListener("click",handleChangeViewType)});[].forEach.call(document.querySelectorAll('[data-toggle\x3d"tooltip"]'),
function(el){el.addEventListener("click",handleToolTipClick)});[].forEach.call(document.querySelectorAll("input"),function(el){el.addEventListener("keydown",function(e){if(e.which==13){e.preventDefault();submitForm()}})})}function submitForm(){showLoadingOverlay();var url=createUrlFromForm();var viewType=getSelectedView();var dates=getStartAndEndDates();displayEvents(viewType,url,dates.startDate,dates.endDate)}
function selectView(viewType){var deferred=jQuery.Deferred();jQuery(".ResultsFilterButton").removeClass("selected");if(jQuery('.ResultsFilterButton[data-value\x3d"'+viewType+'"]').addClass("selected"))deferred.resolve();return deferred}function selectDateInDatePicker(date){var d=moment(date,"YYYY-MM-DD").toDate();jQuery("#DatePicker").datepicker("setDate",d)}
function createUrlFromForm(){var singleParkSelected=jQuery("#SelectedPark").val().length>0?jQuery("#SelectedPark").val():false;var selectedParks=jQuery("#ChoosePark").val();var selectedStates=jQuery("#ChooseState").val();var selectedTypes=jQuery("#ChooseEventType").val();var searchText=jQuery("#form-keyword").val();var selectedOrg=jQuery("#organization").val();var selectedSubject=jQuery("#subject").val();var selectedPortal=jQuery("#portal").val();var tagsAll=jQuery("#tagsAll").val();var tagsOne=jQuery("#tagsOne").val();
var tagsNone=jQuery("#tagsNone").val();var hideRecurring=jQuery("#ShowRepeatedEvents")[0].checked;var dates=getStartAndEndDates();var url="";url+=EVENTS_API_BASE_URL;url+="\x26dateStart\x3d"+dates.startDate;url+="\x26dateEnd\x3d"+dates.endDate;if(selectedOrg.length>0)url+="\x26organization\x3d"+selectedOrg;if(selectedSubject.length>0)url+="\x26subject\x3d"+encodeURIComponent(selectedSubject);if(selectedPortal.length>0)url+="\x26portal\x3d"+selectedPortal;if(tagsAll.length>0)url+="\x26tagsAll\x3d"+
encodeURIComponent(tagsAll);if(tagsOne.length>0)url+="\x26tagsOne\x3d"+encodeURIComponent(tagsOne);if(tagsNone.length>0)url+="\x26tagsNone\x3d"+encodeURIComponent(tagsNone);if(selectedParks!==null&&!singleParkSelected)url+="\x26parkCode\x3d"+selectedParks;if(selectedStates!==null&&!singleParkSelected)url+="\x26stateCode\x3d"+selectedStates;if(selectedTypes!==null)url+="\x26eventType\x3d"+encodeURIComponent(selectedTypes);if(searchText.length>0)url+="\x26q\x3d"+encodeURIComponent(searchText);if(!hideRecurring)url+=
"\x26expandRecurring\x3dtrue";return url}
function getStartAndEndDates(){var startDate=getStartDate();var viewType=getSelectedView();var startMoment=moment(startDate,"YYYY-MM-DD");switch(viewType){case "day":startDate=startMoment.format("YYYY-MM-DD");var endDate=startDate;break;case "week":startDate=startMoment.startOf("week").format("YYYY-MM-DD");endDate=moment(startDate,"YYYY-MM-DD").endOf("week").format("YYYY-MM-DD");break;default:startDate=startMoment.format("YYYY-MM-DD");endDate=startMoment.endOf("month").format("YYYY-MM-DD");break}return{"startDate":startDate,
"endDate":endDate}}function handleChangeViewType(e,viewType){if(!viewType)viewType=e.target.getAttribute("data-value");selectView(viewType).done(function(){var dates=getStartAndEndDates();setStartDate(dates.startDate).done(submitForm)})}function handleDatePickerChangeMonth(e){var start=moment(e.date,"YYYY-MM-DD").startOf("month").format("YYYY-MM-DD");setStartDate(start).done(function(){selectView("month").done(submitForm)})}
function handleDatePickerSelectDay(e){var d=moment(e.date).format("YYYY-MM-DD");var s=getSelectedDayFromDatePicker();if(s)setStartDate(d).done(function(){selectView("day").done(submitForm)});else{var firstOfMonth=moment(getStartDate(),"YYYY-MM-DD").startOf("month").format("YYYY-MM-DD");setStartDate(firstOfMonth).done(function(){selectView("month").done(submitForm)})}}
function handleToolTipClick(e$jscomp$0){var element=e$jscomp$0.currentTarget;element.focus();document.addEventListener("touchstart",function(e){jQuery(element).tooltip("hide")})}function showForm(){document.getElementById("EventCalendar__FormContainer").style.display="block"}function resetForm(){location.reload()}function clearCalendarDots(){jQuery(".EventCalendar__Calendar__Marker").css("visibility","hidden")}
function setStartDate(d){var deferredReady=jQuery.Deferred();var m=moment(d,"YYYY-MM-DD");document.getElementById("SelectedDate").value=m.format("YYYY-MM-DD");deferredReady.resolve();return deferredReady.promise()}function getStartDate(d){return document.getElementById("SelectedDate").value}function getStartOfCurrentMonthShown(){return moment(getStartDate(),"YYYY-MM-DD").startOf("month").format("YYYY-MM-DD")}
function getEndOfCurrentMonthShown(){return moment(getStartDate(),"YYYY-MM-DD").endOf("month").format("YYYY-MM-DD")}
function displayEvents(viewType,url,startDate,endDate){var PAGINATION=jQuery("#ResultsPagination");clearCalendarDots();PAGINATION.pagination({dataSource:url,pageNumber:1,locator:"data",className:"pagination-container",ulClassName:"pagination",hideWhenLessThanOnePage:false,totalNumberLocator:function(response){if(response.dates.length>0){var dates=response.dates.split(",");var d1=new Date(startDate);var filteredDates=dates.filter(function(date){var d2=new Date(date);return d2>=d1});populateCalendar(filteredDates)}return response.total},
pageSize:10,callback:function(data,pagination){populateResultsHeader(pagination,startDate,endDate);if(data.length>0){showPagination();populateResults(data);hideLoadingOverlay()}else{showNoResultsTemplate("month",startDate,endDate);hideLoadingOverlay()}}})}function getSelectedDayFromDatePicker(){var selectedDate=jQuery("#DatePicker").datepicker("getDate");if(selectedDate=="Invalid Date")return false;return moment(selectedDate).format("YYYY-MM-DD")}
function hideLoadingOverlay(){document.getElementsByClassName("LoadingOverlay")[0].style.display="none";document.getElementsByClassName("ResultsContent")[0].style.display="block"}function showLoadingOverlay(){document.getElementsByClassName("LoadingOverlay")[0].style.display="block";document.getElementsByClassName("ResultsContent")[0].style.display="none"}function repeatingEventsAreHidden(){return jQuery("#ShowRepeatedEvents").is(":checked")}
function populateCalendar(dates){clearCalendarDots();[].forEach.call(dates,function(eventDate){var startDate=moment(eventDate,"YYYY-MM-DD");var eventIcon=jQuery("#CalendarDay__"+startDate.month()+"__"+startDate.date()+"__"+startDate.year()).children(".EventCalendar__Calendar__Marker");eventIcon.css("visibility","visible")})}function getSelectedView(){return jQuery(".ResultsFilterButton.selected").data("value")}
function showPagination(){jQuery("#ResultsPaginationBottom").remove();jQuery("#ResultsPagination .pagination li").addClass("page-item");jQuery("#ResultsPagination .pagination a").addClass("page-link");jQuery("#ResultsPagination").show();jQuery("#ResultsPagination").clone(true,true).attr("id","ResultsPaginationBottom").insertAfter("[id^\x3dEventSearchResults]");jQuery("#ResultsPagination").scrollResults()}
jQuery.fn.scrollResults=function(){return this.each(function(){jQuery("html, body").animate({scrollTop:jQuery(this).offset().top},1E3)})};function populateResultsHeader(pagination,startDate,endDate){var template=createResultsHeader(pagination,startDate,endDate);jQuery("#ResultsHeader").html(template)}
function populateResults(data){var view=getSelectedView();var template="";switch(view){case "day":template=createEventsListingDay(data);break;default:template=createEventsListing(data);break}jQuery("#EventSearchResults").html(template)}function showNoResultsTemplate(view,startDate,endDate){populateResultsHeader(null,startDate,endDate);var template=createNoResultsTemplate();jQuery("#EventSearchResults").html(template)}
function clearFormInputs(){jQuery("#ChoosePark, #ChooseState, #ChooseEventType").multiselect("deselectAll",false);jQuery("#ChoosePark, #ChooseState, #ChooseEventType").multiselect("refresh");jQuery("#form-keyword").val("")}
function createEventsListing(events){var template="";var lastEventStartDate="";var tmpEventStartDate="";if(events.length<=0)return createNoResultsTemplate();[].forEach.call(events,function(event,index){tmpEventStartDate=formatDateForEventsListingDateHeader(event);if(lastEventStartDate===tmpEventStartDate)template+=createSingleEventListItem(event);else{template+="\x3c/ul\x3e";template+=createEventsListingDateHeader(events[index]);template+="\x3cul\x3e";template+=createSingleEventListItem(events[index]);
lastEventStartDate=tmpEventStartDate}});template+="\x3c/ul\x3e";return template}function createEventsListingDay(events){if(events.length<=0)return createNoResultsTemplate();var template="\x3cul\x3e";[].forEach.call(events,function(event,index){template+=createSingleEventListItemDayView(event)});template+="\x3c/ul\x3e";return template}
function createNoResultsTemplate(){var template="";template+=' \x3cdiv class\x3d"EventCalendar__NoResults"\x3e';template+='   \x3cdiv class\x3d"EventCalendar__NoResults__Description"\x3eIt doesn\'t look like there are any events to show.\x3c/div\x3e';template+='     \x3cdiv class\x3d"EventCalendar__NoResults__Icon"\x3e';template+='       \x3csvg class\x3d"icon"\x3e\x3cuse xlink:href\x3d"/common/commonspot/templates/assets/sprite.symbol.svg#event-calendar_no-results"\x3e\x3c/use\x3e\x3c/svg\x3e';template+=
"     \x3c/div\x3e";template+='   \x3cdiv class\x3d"EventCalendar__NoResults__Description"\x3eTry searching different dates or criteria.\x3c/div\x3e';template+=" \x3c/div\x3e";template+="\x3c/div\x3e";return template}
function createPaginationTemplate(pagination){var paginationTemplate="";if(pagination==null){paginationTemplate+='   \x3cdiv class\x3d"ListingResults__Pagination col-md-5"\x3e';paginationTemplate+='     \x3cspan class\x3d"ListingResults__Pagination__TotalNum"\x3e No results. \x3c/span\x3e';paginationTemplate+="   \x3c/div\x3e"}else{var paginationEndNum=pagination.pageSize;var paginationStartNum=1;if(pagination.pageNumber>1){paginationEndNum=pagination.pageNumber*pagination.pageSize;paginationStartNum=
paginationEndNum-pagination.pageSize}if(paginationEndNum>pagination.totalNumber)paginationEndNum=pagination.totalNumber;paginationTemplate+='   \x3cdiv class\x3d"ListingResults__Pagination col-md-5"\x3e';paginationTemplate+='     Showing \x3cspan class\x3d"ListingResults__Pagination__StartNum"\x3e'+paginationStartNum+"\x3c/span\x3e -";paginationTemplate+='     \x3cspan class\x3d"ListingResults__Pagination__EndNum"\x3e'+paginationEndNum+"\x3c/span\x3e of";paginationTemplate+='     \x3cspan class\x3d"ListingResults__Pagination__TotalNum"\x3e'+
pagination.totalNumber+"\x3c/span\x3e total results.";paginationTemplate+="   \x3c/div\x3e"}return paginationTemplate}
function createResultsHeader(pagination,startDate,endDate){var repeatingEventsTemplate="";var monthDisclaimer="";var startMoment=moment(startDate,"YYYY-MM-DD");var view=getSelectedView();switch(view){case "day":startDate=startMoment.format("MMMM D, YYYY");endDate=false;break;case "week":var startYear=startMoment.format("YYYY");var endYear=startMoment.endOf("week").format("YYYY");var doesSpanTwoYears=startYear!==endYear;var firstDateFormat="MMMM D";if(doesSpanTwoYears)firstDateFormat="MMMM D, YYYY";
startDate=startMoment.startOf("week").format(firstDateFormat);endDate=startMoment.endOf("week").format("MMMM D, YYYY");break;case "month":startDate=startMoment.format("MMMM YYYY");endDate=false;break}if(view=="month")monthDisclaimer='\x3cdiv class\x3d"row"\x3e\x3cdiv class\x3d"ListingResults__Disclaimer col-md-12"\x3e\x3cspan class\x3d"blackhighlight"\x3eIn Month View, only events from today or selected date to end of month are shown.\x3c/span\x3e\x3c/div\x3e\x3c/div\x3e';var paginationTemplate=createPaginationTemplate(pagination);
if(repeatingEventsAreHidden())repeatingEventsTemplate='\x3cdiv class\x3d"ListingResults__Heading__RepeatedEventsIndicator"\x3eRepeating instances of events are currently hidden\x3c/div\x3e';var template='\x3cdiv id\x3d"ListingResults__Heading"\x3e';template+=' \x3cdiv class\x3d"row"\x3e';template+='   \x3cdiv class\x3d"ListingResults__Heading col-md-7"\x3e';template+='     \x3cspan class\x3d"ListingResults__Heading__PeriodType"\x3e'+view+"\x3c/span\x3e";if(startDate){template+='   \x3cspan class\x3d"ListingResults__Heading__Period ListingResults__Heading__Period--Start"\x3e';
if(view=="week")template+="SUN, ";template+=startDate+"\x3c/span\x3e"}if(endDate){template+='   \x26ndash; \x3cspan class\x3d"ListingResults__Heading__Period ListingResults__Heading__Period--End"\x3e ';if(view=="week")template+="SAT, ";template+=endDate+"\x3c/span\x3e"}template+="   \x3c/div\x3e";template+=paginationTemplate;template+=" \x3c/div\x3e";template+=monthDisclaimer;template+=repeatingEventsTemplate;template+="\x3c/div\x3e";return template}
function createSingleEventListItem(event){var template='\x3cli class\x3d"ListingList__Item ListingResults__Item"\x3e';template+=' \x3cdiv class\x3d"ListingEvent__Header"\x3e';template+='   \x3cdiv class\x3d"row"\x3e';template+='     \x3cdiv class\x3d"ListingEvent__TitleContainer col-sm-8 col-md-9"\x3e';template+='       \x3cspan class\x3d"ListingEvent__Subtitle"\x3e'+event.parkFullName+"\x3c/span\x3e";template+='       \x3ca href\x3d"'+EVENT_DETAIL_BASE_URL+event.id+'" class\x3d"ListingEvent__TitleLink"\x3e';
template+='         \x3ch3 class\x3d"ListingEvent__Title"\x3e'+event.title+"\x3c/h3\x3e";template+="       \x3c/a\x3e";template+="     \x3c/div\x3e";template+=createEventLabelsTemplatePortion(event);template+="   \x3c/div\x3e";template+=" \x3c/div\x3e";var eventStartDate=moment(event.dateStart);var quickDateDay=eventStartDate.format("D");var quickDateMonth=eventStartDate.format("MMM");var quickDateTime="N/A";if(Array.isArray(event.times)&&event.times.length&&event.times[0].hasOwnProperty("timeStart")){quickDateTime=
moment(event.times[0].timeStart,"H:mm a").format("h:mm a");if(quickDateTime=="Invalid date")quickDateTime="\x26nbsp;"}template+='\x3cdiv class\x3d"row"\x3e';template+=' \x3cdiv class\x3d"col-sm-auto"\x3e';template+='   \x3cdiv class\x3d"ListingEvent__QuickDate"\x3e';template+='     \x3cspan class\x3d"ListingEvent__QuickDate--Day"\x3e'+quickDateDay+"\x3c/span\x3e";template+='     \x3cspan class\x3d"ListingEvent__QuickDate--Month"\x3e'+quickDateMonth+"\x3c/span\x3e";template+='     \x3cspan class\x3d"ListingEvent__QuickDate--Time"\x3e'+
quickDateTime+"\x3c/span\x3e";template+="   \x3c/div\x3e";template+=" \x3c/div\x3e";template+=' \x3cdiv class\x3d"col-sm-auto"\x3e';template+=' \x3cdiv class\x3d"ListingEvent__Info"\x3e';template+="   \x3ctable\x3e";template+="     \x3ctr\x3e";template+='       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eDay(s):\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoDays(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="     \x3ctr\x3e";template+=
'       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eDate(s):\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoDates(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="     \x3ctr\x3e";template+='       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eTime(s):\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoTimes(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="     \x3ctr\x3e";template+=
'       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eDuration:\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoDuration(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="   \x3c/table\x3e";template+=" \x3c/div\x3e";template+=" \x3c/div\x3e";template+="\x3c/div\x3e";template+='\x3ca href\x3d"'+EVENT_DETAIL_BASE_URL+event.id+'" class\x3d"ListingResults__ViewDetailsLink carrot-end"\x3eView Details\x3c/a\x3e';template+="\x3c/li\x3e";return template}
function createSingleEventListItemDayView(event){var template='\x3cli class\x3d"ListingList__Item ListingResults__Item"\x3e';template+=' \x3cdiv class\x3d"ListingEvent__Header"\x3e';template+='   \x3cdiv class\x3d"row"\x3e';template+='     \x3cdiv class\x3d"ListingEvent__TitleContainer col-sm-8 col-md-9"\x3e';template+='       \x3cspan class\x3d"ListingEvent__Subtitle"\x3e'+event.parkFullName+"\x3c/span\x3e";template+='       \x3ca href\x3d"'+EVENT_DETAIL_BASE_URL+event.id+'" class\x3d"ListingEvent__TitleLink"\x3e';
template+='         \x3ch3 class\x3d"ListingEvent__Title"\x3e'+event.title+"\x3c/h3\x3e";template+="       \x3c/a\x3e";template+="     \x3c/div\x3e";template+=createEventLabelsTemplatePortion(event);template+="   \x3c/div\x3e";template+=" \x3c/div\x3e";var eventStartDate=moment(event.dateStart);var quickDateDay=eventStartDate.format("D");var quickDateMonth=eventStartDate.format("MMM");var quickDateTime="N/A";if(Array.isArray(event.times)&&event.times.length&&event.times[0].hasOwnProperty("timeStart")){quickDateTime=
moment(event.times[0].timeStart,"H:mm a").format("h:mm a");if(quickDateTime=="Invalid date")quickDateTime="\x26nbsp;"}template+='\x3cdiv class\x3d"row"\x3e';template+=' \x3cdiv class\x3d"col-sm-auto"\x3e';template+='   \x3cdiv class\x3d"ListingEvent__QuickDate"\x3e';template+='     \x3cspan class\x3d"ListingEvent__QuickDate--Day"\x3e'+quickDateDay+"\x3c/span\x3e";template+='     \x3cspan class\x3d"ListingEvent__QuickDate--Month"\x3e'+quickDateMonth+"\x3c/span\x3e";template+='     \x3cspan class\x3d"ListingEvent__QuickDate--Time"\x3e'+
quickDateTime+"\x3c/span\x3e";template+="   \x3c/div\x3e";template+=" \x3c/div\x3e";template+=' \x3cdiv class\x3d"col-sm-auto"\x3e';template+=' \x3cdiv class\x3d"ListingEvent__Info"\x3e';template+="   \x3ctable\x3e";template+="     \x3ctr\x3e";template+='       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eDay(s):\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoDays(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="     \x3ctr\x3e";template+=
'       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eDate(s):\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoDates(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="     \x3ctr\x3e";template+='       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eTime(s):\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoTimes(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="     \x3ctr\x3e";template+=
'       \x3ctd class\x3d"ListingEvent__Info__Heading"\x3eDuration:\x3c/td\x3e';template+='       \x3ctd class\x3d"ListingEvent__Info__Data"\x3e'+createEventInfoDuration(event)+"\x3c/td\x3e";template+="     \x3c/tr\x3e";template+="   \x3c/table\x3e";template+=" \x3c/div\x3e";template+=" \x3c/div\x3e";template+="\x3c/div\x3e";template+='\x3cdiv class\x3d"ListingInfoExtended"\x3e';template+=' \x3cdiv class\x3d"row"\x3e';template+='   \x3cdiv class\x3d"col-sm-auto order-sm-1"\x3e';template+='     \x3cdiv class\x3d"ListingMeta"\x3e';
template+="       \x3ctable\x3e";if(Array.isArray(event.types)&&event.types.length)template+='         \x3ctr\x3e\x3ctd class\x3d"ListingMeta__Label"\x3eType:\x3c/td\x3e\x3ctd\x3e'+createEventInfoTypes(event)+"\x3c/td\x3e\x3c/tr\x3e";if(Array.isArray(event.TAGS)&&event.TAGS.length)template+='         \x3ctr\x3e\x3ctd class\x3d"ListingMeta__Label"\x3eTags:\x3c/td\x3e\x3ctd\x3e'+createEventInfoTags(event)+"\x3c/td\x3e\x3c/tr\x3e";template+="       \x3c/table\x3e";template+="     \x3c/div\x3e";template+=
"   \x3c/div\x3e";if(event.images.length){template+='   \x3cdiv class\x3d"col-sm-auto"\x3e';template+='     \x3cimg class\x3d"ListingResults-thumbnail" src\x3d"https://www.nps.gov/'+event.images[0].path+'?width\x3d150\x26height\x3d150\x26bgcolor\x3d888888\x26autorotate\x3dfalse\x26quality\x3d90" alt\x3d"thumbnail"\x3e';template+="   \x3c/div\x3e"}template+=" \x3c/div\x3e";template+="\x3c/div\x3e";template+='\x3ca href\x3d"'+EVENT_DETAIL_BASE_URL+event.id+'" class\x3d"ListingResults__ViewDetailsLink carrot-end"\x3eView Details\x3c/a\x3e';
template+="\x3c/li\x3e";return template}
function createEventLabelsTemplatePortion(event){var template='\x3cdiv class\x3d"ListingEvent__EventTypesContainer col-sm-4 col-md-3"\x3e';if(Array.isArray(event.times)&&event.times.length&&event.times[0].hasOwnProperty("sunriseStart")){if(event.times[0].sunriseStart===1){template+=' \x3cdiv class\x3d"ListingEvent__EventType ListingEvent__EventType--Sunrise"\x3e';template+='   \x3csvg class\x3d"icon"\x3e\x3cuse xlink:href\x3d"/common/commonspot/templates/assets/sprite.symbol.svg#sunrise"\x3e\x3c/use\x3e\x3c/svg\x3e\x3cspan\x3eSunrise\x3c/span\x3e';template+=
" \x3c/div\x3e"}if(event.times[0].sunsetEnd===1){template+=' \x3cdiv class\x3d"ListingEvent__EventType ListingEvent__EventType--Sunset"\x3e';template+='   \x3csvg class\x3d"icon"\x3e\x3cuse xlink:href\x3d"/common/commonspot/templates/assets/sprite.symbol.svg#sunset"\x3e\x3c/use\x3e\x3c/svg\x3e\x3cspan\x3eSunset\x3c/span\x3e';template+=" \x3c/div\x3e"}}if(isRecurringEvent(event)){template+=' \x3cdiv class\x3d"ListingEvent__EventType ListingEvent__EventType--Repeating"\x3e';template+='   \x3csvg class\x3d"icon"\x3e\x3cuse xlink:href\x3d"/common/commonspot/templates/assets/sprite.symbol.svg#repeating-event"\x3e\x3c/use\x3e\x3c/svg\x3e\x3cspan\x3eRepeating Event\x3c/span\x3e';
template+=" \x3c/div\x3e"}if(isMultiDayEvent(event)){template+=' \x3cdiv class\x3d"ListingEvent__EventType ListingEvent__EventType--MultiDay"\x3e';template+='   \x3csvg class\x3d"icon"\x3e\x3cuse xlink:href\x3d"/common/commonspot/templates/assets/sprite.symbol.svg#multiday-event"\x3e\x3c/use\x3e\x3c/svg\x3e\x3cspan\x3eMultiday Event\x3c/span\x3e';template+=" \x3c/div\x3e"}if(isSpecialEvent(event)){template+=' \x3cdiv class\x3d"ListingEvent__EventType ListingEvent__EventType--GoldStar"\x3e';template+=
'   \x3csvg class\x3d"icon"\x3e\x3cuse xlink:href\x3d"/common/commonspot/templates/assets/sprite.symbol.svg#gold-star"\x3e\x3c/use\x3e\x3c/svg\x3e\x3cspan\x3eSpecial Event\x3c/span\x3e';template+=" \x3c/div\x3e"}template+="\x3c/div\x3e";return template}function createEventsListingDateHeader(event){var startDate=formatDateForEventsListingDateHeader(event);return'\x3cdiv class\x3d"ListingResults__DateHeader"\x3e\x3cspan\x3e'+startDate+"\x3c/span\x3e\x3c/div\x3e"}
function createEventInfoDays(event){if(!isRecurringEvent(event))return moment(event.dateStart,"YYYY-MM-DD").format("dddd");else{var ruleSplit=event.recurrenceRule.split("|");var rule=new RRule(RRule.parseString(ruleSplit[0]));var dateEnd=moment(rule.options.until).format("MMMM D, YYYY");var recurrenceString=rule.toText();if(recurrenceString.indexOf("every week on Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday")!==-1)recurrenceString=recurrenceString.replace("every week on Monday, Tuesday, Wednesday, Thursday, Friday, Saturday, Sunday",
"Every day");var recurrenceStringSplit=recurrenceString.split("until");recurrenceString=recurrenceStringSplit[0]+"until"+" "+dateEnd;recurrenceString=recurrenceString.charAt(0).toUpperCase()+recurrenceString.slice(1);if(rule.options.bysetpos!=null){var week_pos=rule.options.bysetpos[0];var weekday=rule.options.byweekday[0];recurrenceString="Monthly on the "+CARDINAL_NAMES[week_pos-1]+" "+WEEKDAY_NAMES[weekday]}var exceptionDates=[];var exceptionString="";if(ruleSplit.length>1&&ruleSplit[1].indexOf("EXDATE\x3d")===
0){var exceptionCSV=ruleSplit[1].substr(7);exceptionDates=exceptionCSV.split(",");exceptionString+=" (except for ";for(var i=0;i<exceptionDates.length;i++){var moreThanOneException=exceptionDates.length>1;var lastItem=i===exceptionDates.length-1&&moreThanOneException;var itemBeforeLast=i===exceptionDates.length-2;if(lastItem)exceptionString+="and ";var exception=exceptionDates[i];var exceptionDate=moment(exception,"YYYY-MM-DD").format("MM/DD");exceptionString+=exceptionDate;if(!lastItem&&!itemBeforeLast&&
moreThanOneException)exceptionString+=", ";else if(!lastItem&&moreThanOneException)exceptionString+=" "}if(exceptionString.length!=="")exceptionString+=")"}return recurrenceString+exceptionString}}
function createEventInfoDates(event){var dateStart=moment(event.dateStart,"YYYY-MM-DD").format("MMMM D, YYYY");var dateEnd=moment(event.dateEnd,"YYYY-MM-DD").format("MMMM D, YYYY");if(isRecurringEvent(event))dateEnd=moment(event.recurrenceDateEnd,"YYYY-MM-DD").format("MMMM D, YYYY");if(!isRecurringEvent(event)&&!isMultiDayEvent(event))return dateStart;return dateStart+", to "+dateEnd}
function createEventInfoTimes(event){var template="";var spacer="";var eventHasTimeData=Array.isArray(event.times)&&event.times.length?true:false;var startTime=false;var endTime=false;if(eventHasTimeData){template="\x3cul\x3e";event.times.forEach(function(time){if(time.sunriseStart==true)startTime="Sunrise";else if(time.hasOwnProperty("timeStart")){var startMoment=moment(time.timeStart,"HH:mm a");if(startMoment.format("m")==0)startTime=startMoment.format("h a");else startTime=startMoment.format("h:mm a")}if(time.sunsetEnd==
true)endTime="Sunset";else if(time.hasOwnProperty("timeEnd")){var endMoment=moment(time.timeEnd,"HH:mm a");if(endMoment.format("m")==0)endTime=endMoment.format("h a");else endTime=endMoment.format("h:mm a")}if(startTime&&endTime)if(startTime===endTime)template+="\x3cli\x3e"+startTime+"\x3c/li\x3e";else template+="\x3cli\x3e"+startTime+" \x26mdash; "+endTime+"\x3c/li\x3e";else if(event.isAllDay)template+="\x3cli\x3eAll day\x3c/li\x3e";else template+="\x3cli\x3e"+startTime+"\x3c/li\x3e"});template+=
"\x3c/ul\x3e"}else template="N/A";return template}
function createEventInfoDuration(event){var template="N/A";var eventHasTimeData=Array.isArray(event.times)&&event.times.length?true:false;if(eventHasTimeData){var time=event.times[0];var eventHasBothStartAndEndTimes=time.hasOwnProperty("timeStart")&&time.hasOwnProperty("timeEnd")&&time.timeStart.length>0&&time.timeEnd.length>0?true:false;if(event.hasOwnProperty("isAllDay")&&event.isAllDay===true)template="All day.";if(eventHasBothStartAndEndTimes&&time.timeStart!==time.timeEnd){var startMoment=moment(time.timeStart,
"H:mm");var endMoment=moment(time.timeEnd,"H:mm");if(time.timeStart.indexOf("PM")!==-1&&time.timeStart.indexOf("12:")==-1)startMoment=startMoment.add(12,"hours");if(time.timeEnd.indexOf("PM")!==-1&&time.timeEnd.indexOf("12:")==-1)endMoment=endMoment.add(12,"hours");var duration=moment.duration(endMoment.diff(startMoment,"minutes")).milliseconds();if(duration<0)duration*=-1;var durationString=createEventInfoDurationString(duration);template=durationString}}return template}
function createEventInfoDurationString(duration){var template="";var hours=Math.floor(duration/60);var minutes=duration-hours*60;if(hours>1)template+=hours+" hours";else if(hours==1)template+="1 hour";if(minutes>0){if(hours>=1)template+=" and ";template+=minutes+" minutes"}return template}function createEventInfoTags(event){return event.TAGS.join(", ")}function createEventInfoTypes(event){return event.types.join(", ")}
function isSunriseOrSunsetEvent(event){if(typeof event.times[0]==="undefined")return false;if(event.times[0].sunsetEnd==1||event.times[0].sunriseStart==1)return true;return false}function isSunriseEvent(event){if(typeof event.times[0]==="undefined")return false;if(event.times[0].sunsetEnd==1||event.times[0].sunriseStart==1)return true;return false}function isRecurringEvent(event){if(event.isRecurring&&event.recurrenceRule.length>0)return true;return false}
function isMultiDayEvent(event){var dateStart=moment(event.dateStart,"YYYY-MM-DD");var dateEnd=moment(event.dateEnd,"YYYY-MM-DD");var eventDays=dateEnd.diff(dateStart,"days");if(eventDays>0)return true;return false}function isSpecialEvent(event){if(event.category==="Special Event")return true;return false}
function formatDateForEventsListingDateHeader(event){var selectedView=document.querySelectorAll(".ResultsFilterButton.selected")[0];var formattedDateForHeader="";if(!selectedView)formattedDateForHeader=moment(event.dateStart).format("MMMM Do, YYYY").toString();else formattedDateForHeader=moment(event.dateStart).format("dddd, MMMM Do").toString();return formattedDateForHeader};